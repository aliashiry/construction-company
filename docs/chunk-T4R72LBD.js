import{a as d}from"./chunk-3O4E2BZ4.js";import{a as i,b as a,c as m}from"./chunk-Y2WE23YX.js";import{A as s,R as g,W as h,n as l,r as o}from"./chunk-DYVC5MWC.js";var u=class p{constructor(e){this.http=e}API_URL=`${d.BASE_URL}`;getHeaders(){let e=localStorage.getItem("AUTH_TOKEN")||"";return new i({"Content-Type":"application/json",Authorization:`Bearer ${e}`})}handleError(e){console.error("API Error:",e);let t=e.error?.message||e.message||"An error occurred";return l(()=>new Error(t))}getFullFileData(e){let t=new a().set("userId",e.toString());return this.http.get(`${this.API_URL}/history/files/full-data`,{headers:this.getHeaders(),params:t}).pipe(s(this.handleError))}getFiles(e){let t=new a().set("userId",e.toString());return this.http.get(`${this.API_URL}/history/files`,{headers:this.getHeaders(),params:t}).pipe(o(r=>r.files||[]),s(this.handleError))}getFilesCount(e){let t=new a().set("userId",e.toString());return this.http.get(`${this.API_URL}/history/files/count`,{headers:this.getHeaders(),params:t}).pipe(o(r=>r.count||0),s(this.handleError))}getProjectsCount(e){let t=new a().set("userId",e.toString());return this.http.get(`${this.API_URL}/history/projects/count`,{headers:this.getHeaders(),params:t}).pipe(o(r=>r.count||0),s(this.handleError))}uploadFile(e){let t=new FormData;return t.append("UserID",e.UserID.toString()),t.append("ProjectName",e.ProjectName),t.append("FileName",e.FileName),e.InputFileData&&t.append("InputFileData",e.InputFileData),t.append("Notes",e.Notes||""),this.http.post(`${this.API_URL}/history/input`,t,{headers:new i({Authorization:`Bearer ${localStorage.getItem("AUTH_TOKEN")||""}`})}).pipe(s(this.handleError))}uploadOutputFile(e){let t=new FormData;return t.append("ManagerID",e.managerID.toString()),t.append("ProjectName",e.projectName),t.append("FileName",e.fileName),t.append("OutputFileData",e.outputFileData),this.http.post(`${this.API_URL}/history/output`,t,{headers:new i({Authorization:`Bearer ${localStorage.getItem("AUTH_TOKEN")||""}`})}).pipe(s(this.handleError))}downloadFile(e,t,r){let n=new a().set("managerID",e.toString()).set("projectName",t).set("fileName",r);return this.http.get(`${this.API_URL}/history/output/download`,{headers:this.getHeaders(),params:n,responseType:"blob"}).pipe(s(this.handleError))}downloadAllFiles(e){let t=new a().set("managerID",e.toString());return this.http.get(`${this.API_URL}/history/output/download/all`,{headers:this.getHeaders(),params:t,responseType:"blob"}).pipe(s(this.handleError))}getFileStatus(e,t,r){let n=new a().set("managerID",e.toString()).set("projectName",t).set("fileName",r);return this.http.get(`${this.API_URL}/history/output/status`,{headers:this.getHeaders(),params:n}).pipe(s(this.handleError))}deleteFile(e,t,r){let n=new a().set("managerID",e.toString()).set("projectName",t).set("fileName",r);return this.http.delete(`${this.API_URL}/history/file/delete`,{headers:this.getHeaders(),params:n}).pipe(s(this.handleError))}getWorkers(e,t){let r=new a().set("managerId",e.toString());return t&&(r=r.set("projectName",t)),this.http.get(`${this.API_URL}/WorkerOn`,{headers:this.getHeaders(),params:r}).pipe(s(this.handleError))}getWorkerAssignedFiles(e){return this.http.get(`${this.API_URL}/WorkerOn/assign/MyFiles/${e}`,{headers:this.getHeaders()}).pipe(s(this.handleError))}getProjectManagers(e,t){let r=new a().set("userid",t.toString());return this.http.get(`${this.API_URL}/WorkerOn/manager/${encodeURIComponent(e)}`,{headers:this.getHeaders(),params:r}).pipe(s(this.handleError))}addWorkerByEmail(e){return this.http.post(`${this.API_URL}/WorkerOn/addworker`,{useremail:e.email,ManagerID:e.managerID,ProjectName:e.projectName,role:e.role||"Worker"},{headers:this.getHeaders()}).pipe(s(this.handleError))}addWorker(e){return this.http.post(`${this.API_URL}/WorkerOn/addworker`,{userId:e.userId,userName:e.userName,managerID:e.managerID,projectName:e.projectName,role:e.role||"Worker",assignedDate:new Date().toISOString()},{headers:this.getHeaders()}).pipe(s(this.handleError))}removeWorkerByEmail(e,t,r){return this.http.delete(`${this.API_URL}/WorkerOn/rmworker`,{headers:this.getHeaders(),body:{WorkerEmail:e,ManagerID:t,ProjectName:r}}).pipe(s(this.handleError))}removeWorker(e,t,r){let n=new a().set("userId",e.toString()).set("managerID",t.toString()).set("projectName",r);return this.http.delete(`${this.API_URL}/WorkerOn/rmworker`,{headers:this.getHeaders(),params:n}).pipe(s(this.handleError))}editOutputFile(e){let t=new FormData;return t.append("UserId",e.userId.toString()),t.append("ManagerID",e.managerID.toString()),t.append("ProjectName",e.projectName),t.append("FileName",e.fileName),e.outputFileData&&t.append("OutputFileData",e.outputFileData),e.notes&&t.append("Notes",e.notes),this.http.post(`${this.API_URL}/WorkerOn/editoutputfile`,t,{headers:new i({Authorization:`Bearer ${localStorage.getItem("AUTH_TOKEN")||""}`})}).pipe(s(this.handleError))}getProjects(e){let t=new a().set("managerID",e.toString());return this.http.get(`${this.API_URL}/history/projects`,{headers:this.getHeaders(),params:t}).pipe(s(this.handleError))}formatFileSize(e){if(e===0)return"0 Bytes";let t=1024,r=["Bytes","KB","MB","GB"],n=Math.floor(Math.log(e)/Math.log(t));return Math.round(e/Math.pow(t,n)*100)/100+" "+r[n]}isImageFile(e){let t=[".jpg",".jpeg",".png",".gif",".bmp",".svg",".webp"],r=e.substring(e.lastIndexOf(".")).toLowerCase();return t.includes(r)}getFileExtension(e){return e.substring(e.lastIndexOf(".")+1).toLowerCase()}getFileIcon(e){let t=this.getFileExtension(e);return{pdf:"\u{1F4C4}",doc:"\u{1F4DD}",docx:"\u{1F4DD}",xls:"\u{1F4CA}",xlsx:"\u{1F4CA}",ppt:"\u{1F4CA}",pptx:"\u{1F4CA}",txt:"\u{1F4CB}",zip:"\u{1F5DC}\uFE0F",rar:"\u{1F5DC}\uFE0F",jpg:"\u{1F5BC}\uFE0F",jpeg:"\u{1F5BC}\uFE0F",png:"\u{1F5BC}\uFE0F",gif:"\u{1F5BC}\uFE0F",mp4:"\u{1F3AC}",avi:"\u{1F3AC}",mp3:"\u{1F3B5}",wav:"\u{1F3B5}"}[t]||"\u{1F4C1}"}isValidFileType(e,t){let r=this.getFileExtension(e);return t.includes(r)}getDaysDifference(e){let t=new Date(e),n=Math.abs(new Date().getTime()-t.getTime());return Math.ceil(n/(1e3*60*60*24))}static \u0275fac=function(t){return new(t||p)(h(m))};static \u0275prov=g({token:p,factory:p.\u0275fac,providedIn:"root"})};export{u as a};
