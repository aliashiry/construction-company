import{a as S}from"./chunk-LPWP3JNO.js";import"./chunk-3O4E2BZ4.js";import"./chunk-ZT6EOFWV.js";import{$ as C,$a as r,Ba as s,Ca as y,Jb as O,Kb as P,Ma as x,Ob as k,Pa as p,Ra as _,Sa as e,Ta as n,Ua as d,Xa as v,Ya as h,Za as g,ab as f,ha as u,hb as M,ia as b,ja as c,ka as m}from"./chunk-WHKR5R2A.js";function E(a,i){a&1&&(e(0,"div",14),d(1,"div",15),e(2,"p",16),r(3,"Loading your file history..."),n()())}function I(a,i){if(a&1){let t=v();e(0,"div",17),c(),e(1,"svg",18),d(2,"path",19),n(),m(),e(3,"h3",20),r(4),n(),e(5,"button",21),h("click",function(){u(t);let l=g();return b(l.refreshHistory())}),r(6,"Try Again"),n()()}if(a&2){let t=g();s(4),f(t.errorMessage)}}function j(a,i){a&1&&(e(0,"div",22),c(),e(1,"svg",23),d(2,"path",24),n(),m(),e(3,"h3",25),r(4,"No Files Found"),n(),e(5,"p",26),r(6,"You haven't uploaded any files yet. Start by uploading your first file!"),n()())}function F(a,i){if(a&1&&(e(0,"div",59),c(),e(1,"svg",60),d(2,"path",61),n(),m(),e(3,"span",62),r(4),n()()),a&2){let t=g().$implicit;s(4),f(t.notes)}}function L(a,i){a&1&&(e(0,"span",63),r(1,"\u2014"),n())}function z(a,i){if(a&1){let t=v();e(0,"tr",38)(1,"td",39)(2,"div",40),c(),e(3,"svg",41),d(4,"path",42),n(),m(),e(5,"span",43),r(6),n()()(),e(7,"td",44)(8,"button",45),h("click",function(){let l=u(t).$implicit,w=g(2);return b(w.downloadAllFiles(l.projectName,l.fileName))}),c(),e(9,"svg",46),d(10,"path",47),n(),m(),e(11,"span",48),r(12),n()()(),e(13,"td",49)(14,"button",50),h("click",function(){let l=u(t).$implicit,w=g(2);return b(w.downloadOutputFile(l.projectName,l.fileName))}),c(),e(15,"svg",46),d(16,"path",47),n(),m(),e(17,"span",48),r(18),n()()(),e(19,"td",51),x(20,F,5,1,"div",52)(21,L,2,0,"span",53),n(),e(22,"td",54)(23,"div",55),c(),e(24,"svg",56),d(25,"path",57),n(),m(),e(26,"span",58),r(27),n()()()()}if(a&2){let t=i.$implicit,o=i.index,l=g(2);_("even-row",o%2===0),s(6),f(t.projectName),s(6),f(t.fileName),s(6),f(t.fileName),s(2),p("ngIf",t.notes),s(),p("ngIf",!t.notes),s(6),f(l.formatDate(t.dateCreate))}}function V(a,i){if(a&1&&(e(0,"div",27)(1,"div",28)(2,"table",29)(3,"thead")(4,"tr")(5,"th",30),r(6,"Project Name"),n(),e(7,"th",31),r(8,"Input File"),n(),e(9,"th",32),r(10,"Output File"),n(),e(11,"th",33),r(12,"notes"),n(),e(13,"th",34),r(14,"Date Created"),n()()(),e(15,"tbody"),x(16,z,28,8,"tr",35),n()()(),e(17,"div",36)(18,"p",37)(19,"strong"),r(20),n(),r(21," file(s) found "),n()()()),a&2){let t=g();s(16),p("ngForOf",t.fileHistory),s(4),f(t.fileHistory.length)}}var H=class a{constructor(i){this.uploadService=i}fileHistory=[];isLoading=!0;errorMessage="";userId=0;ngOnInit(){this.loadUserHistory()}loadUserHistory(){let i=localStorage.getItem("CURRENT_USER");if(!i){this.errorMessage="Please login to view history",this.isLoading=!1;return}let t=JSON.parse(i);this.userId=t.id,this.uploadService.getFullFileData(this.userId).subscribe({next:o=>{this.fileHistory=o.fullFileData||[],this.isLoading=!1,console.log("\u2705 File History Loaded:",this.fileHistory)},error:o=>{console.error("\u274C Error loading history:",o),this.errorMessage="Failed to load file history",this.isLoading=!1}})}downloadAllFiles(i,t){this.uploadService.downloadAllFiles(this.userId,i,t).subscribe({next:o=>{let l=t.substring(0,t.lastIndexOf("."));this.saveFile(o,`Project-${i}_${l}.zip`)},error:o=>{console.error("Error downloading input file:",o),alert("Failed to download input file")}})}downloadOutputFile(i,t){this.uploadService.downloadOutputFile(this.userId,i,t).subscribe({next:o=>{let l=t.replace(/\.(dxf|DXF|dwg|DWG)$/i,"");this.saveFile(o,`${l}_output.csv`)},error:o=>{console.error("\u274C Error downloading output file:",o),alert("Failed to download output file")}})}saveFile(i,t){let o=window.URL.createObjectURL(i),l=document.createElement("a");l.href=o,l.download=t,document.body.appendChild(l),l.click(),document.body.removeChild(l),window.URL.revokeObjectURL(o)}formatDate(i){return i?(typeof i=="string"?new Date(i):i).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}):"N/A"}refreshHistory(){this.isLoading=!0,this.errorMessage="",this.loadUserHistory()}static \u0275fac=function(t){return new(t||a)(y(S))};static \u0275cmp=C({type:a,selectors:[["app-history"]],standalone:!0,features:[M],decls:17,vars:7,consts:[[1,"history-container"],[1,"history-header"],[1,"header-content"],[1,"history-title"],["xmlns","http://www.w3.org/2000/svg","fill","none","viewBox","0 0 24 24","stroke","currentColor",1,"title-icon"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"],[1,"history-subtitle"],[1,"refresh-btn",3,"click","disabled"],["xmlns","http://www.w3.org/2000/svg","fill","none","viewBox","0 0 24 24","stroke","currentColor",1,"refresh-icon"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"],["class","loading-state",4,"ngIf"],["class","error-state",4,"ngIf"],["class","empty-state",4,"ngIf"],["class","table-wrapper",4,"ngIf"],[1,"loading-state"],[1,"spinner"],[1,"loading-text"],[1,"error-state"],["xmlns","http://www.w3.org/2000/svg","fill","none","viewBox","0 0 24 24","stroke","currentColor",1,"error-icon"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"],[1,"error-title"],[1,"retry-btn",3,"click"],[1,"empty-state"],["xmlns","http://www.w3.org/2000/svg","fill","none","viewBox","0 0 24 24","stroke","currentColor",1,"empty-icon"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M7 21h10a2 2 0 002-2V9.414a1 1 0 00-.293-.707l-5.414-5.414A1 1 0 0012.586 3H7a2 2 0 00-2 2v14a2 2 0 002 2z"],[1,"empty-title"],[1,"empty-text"],[1,"table-wrapper"],[1,"table-container"],[1,"history-table"],[1,"th-project"],[1,"th-input"],[1,"th-output"],[1,"th-notes"],[1,"th-date"],["class","table-row",3,"even-row",4,"ngFor","ngForOf"],[1,"table-footer"],[1,"footer-text"],[1,"table-row"],[1,"td-project"],[1,"project-cell"],["xmlns","http://www.w3.org/2000/svg","fill","none","viewBox","0 0 24 24","stroke","currentColor",1,"project-icon"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M3 7v10a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2h-6l-2-2H5a2 2 0 00-2 2z"],[1,"project-name"],[1,"td-input"],[1,"download-btn","input-download",3,"click"],["xmlns","http://www.w3.org/2000/svg","fill","none","viewBox","0 0 24 24","stroke","currentColor",1,"btn-icon"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"],[1,"btn-text"],[1,"td-output"],[1,"download-btn","output-download",3,"click"],[1,"td-notes"],["class","notes-cell",4,"ngIf"],["class","no-notes",4,"ngIf"],[1,"td-date"],[1,"date-cell"],["xmlns","http://www.w3.org/2000/svg","fill","none","viewBox","0 0 24 24","stroke","currentColor",1,"date-icon"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"],[1,"date-text"],[1,"notes-cell"],["xmlns","http://www.w3.org/2000/svg","fill","none","viewBox","0 0 24 24","stroke","currentColor",1,"notes-icon"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M7 8h10M7 12h4m1 8l-4-4H5a2 2 0 01-2-2V6a2 2 0 012-2h14a2 2 0 012 2v8a2 2 0 01-2 2h-3l-4 4z"],[1,"notes-text"],[1,"no-notes"]],template:function(t,o){t&1&&(e(0,"div",0)(1,"div",1)(2,"div",2)(3,"h1",3),c(),e(4,"svg",4),d(5,"path",5),n(),r(6," File History "),n(),m(),e(7,"p",6),r(8,"View and download all your uploaded files"),n()(),e(9,"button",7),h("click",function(){return o.refreshHistory()}),c(),e(10,"svg",8),d(11,"path",9),n(),r(12," Refresh "),n()(),x(13,E,4,0,"div",10)(14,I,7,1,"div",11)(15,j,7,0,"div",12)(16,V,22,2,"div",13),n()),t&2&&(s(9),p("disabled",o.isLoading),s(),_("spinning",o.isLoading),s(3),p("ngIf",o.isLoading),s(),p("ngIf",!o.isLoading&&o.errorMessage),s(),p("ngIf",!o.isLoading&&!o.errorMessage&&o.fileHistory.length===0),s(),p("ngIf",!o.isLoading&&!o.errorMessage&&o.fileHistory.length>0))},dependencies:[k,O,P],styles:[".history-container[_ngcontent-%COMP%]{max-width:1600px;margin:0 auto;padding:2rem;min-height:100vh;background:linear-gradient(135deg,#f8fafc,#e2e8f0)}.history-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:2rem;padding-bottom:1.5rem;border-bottom:3px solid #f97316}.header-content[_ngcontent-%COMP%]{flex:1}.history-title[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.75rem;font-size:2.5rem;font-weight:800;color:#0f172a;margin:0 0 .5rem}.title-icon[_ngcontent-%COMP%]{width:2.5rem;height:2.5rem;color:#f97316}.history-subtitle[_ngcontent-%COMP%]{font-size:1.125rem;color:#64748b;margin:0}.refresh-btn[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.5rem;padding:.75rem 1.5rem;background:linear-gradient(135deg,#f97316,#ea580c);color:#fff;border:none;border-radius:.75rem;font-weight:700;font-size:1rem;cursor:pointer;transition:all .3s ease;box-shadow:0 4px 6px #f973164d}.refresh-btn[_ngcontent-%COMP%]:hover:not(:disabled){transform:translateY(-2px);box-shadow:0 6px 12px #f9731666}.refresh-btn[_ngcontent-%COMP%]:disabled{opacity:.6;cursor:not-allowed}.refresh-icon[_ngcontent-%COMP%]{width:1.25rem;height:1.25rem}.refresh-icon.spinning[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_spin 1s linear infinite}@keyframes _ngcontent-%COMP%_spin{0%{transform:rotate(0)}to{transform:rotate(360deg)}}.loading-state[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;padding:5rem 2rem;gap:1.5rem}.spinner[_ngcontent-%COMP%]{width:60px;height:60px;border:5px solid #e2e8f0;border-top-color:#f97316;border-radius:50%;animation:_ngcontent-%COMP%_spin .8s linear infinite}.loading-text[_ngcontent-%COMP%]{font-size:1.25rem;color:#64748b;font-weight:600}.error-state[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;padding:4rem 2rem;gap:1rem;background:#fef2f2;border:2px solid #fca5a5;border-radius:1rem;text-align:center}.error-icon[_ngcontent-%COMP%]{width:4rem;height:4rem;color:#dc2626}.error-title[_ngcontent-%COMP%]{font-size:1.5rem;font-weight:700;color:#991b1b;margin:0}.retry-btn[_ngcontent-%COMP%]{margin-top:1rem;padding:.75rem 2rem;background:#dc2626;color:#fff;border:none;border-radius:.5rem;font-weight:700;cursor:pointer;transition:all .2s ease}.retry-btn[_ngcontent-%COMP%]:hover{background:#b91c1c;transform:translateY(-2px)}.empty-state[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;padding:5rem 2rem;gap:1rem;background:#fff;border:3px dashed #cbd5e1;border-radius:1rem;text-align:center}.empty-icon[_ngcontent-%COMP%]{width:5rem;height:5rem;color:#cbd5e1}.empty-title[_ngcontent-%COMP%]{font-size:1.75rem;font-weight:700;color:#475569;margin:0}.empty-text[_ngcontent-%COMP%]{font-size:1.125rem;color:#94a3b8;max-width:500px}.table-wrapper[_ngcontent-%COMP%]{background:#fff;border-radius:1rem;box-shadow:0 10px 25px #0000001a;overflow:hidden}.table-container[_ngcontent-%COMP%]{overflow-x:auto}.history-table[_ngcontent-%COMP%]{width:100%;border-collapse:collapse;font-size:.95rem}.history-table[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]{background:linear-gradient(135deg,#0f172a,#1e293b);color:#fff}.history-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{padding:1.25rem 1.5rem;text-align:left;font-weight:700;font-size:.875rem;text-transform:uppercase;letter-spacing:.05em;white-space:nowrap}.th-project[_ngcontent-%COMP%]{border-bottom:4px solid #fbbf24}.th-input[_ngcontent-%COMP%]{border-bottom:4px solid #60a5fa}.th-output[_ngcontent-%COMP%]{border-bottom:4px solid #34d399}.th-notes[_ngcontent-%COMP%]{border-bottom:4px solid #a78bfa}.th-date[_ngcontent-%COMP%]{border-bottom:4px solid #f472b6}.table-row[_ngcontent-%COMP%]{transition:all .2s ease;border-bottom:1px solid #e2e8f0}.table-row[_ngcontent-%COMP%]:hover{background:#f8fafc;transform:scale(1.005);box-shadow:0 2px 8px #f9731626}.table-row.even-row[_ngcontent-%COMP%]{background:#fafafa}.table-row.even-row[_ngcontent-%COMP%]:hover{background:#f1f5f9}.history-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:1.25rem 1.5rem;vertical-align:middle}.td-project[_ngcontent-%COMP%]{font-weight:600}.project-cell[_ngcontent-%COMP%]{display:inline-flex;align-items:center;gap:.75rem;background:linear-gradient(135deg,#fef3c7,#fde68a);color:#92400e;padding:.625rem 1.25rem;border-radius:.75rem;font-weight:700;border:2px solid #fbbf24;white-space:nowrap}.project-icon[_ngcontent-%COMP%]{width:1.25rem;height:1.25rem;flex-shrink:0}.project-name[_ngcontent-%COMP%]{font-size:.95rem}.download-btn[_ngcontent-%COMP%]{display:inline-flex;align-items:center;gap:.625rem;padding:.75rem 1.25rem;border-radius:.75rem;font-weight:600;font-size:.9rem;cursor:pointer;transition:all .25s ease;border:2px solid transparent;width:100%;max-width:280px;white-space:nowrap;overflow:hidden}.btn-icon[_ngcontent-%COMP%]{width:1.125rem;height:1.125rem;flex-shrink:0}.btn-text[_ngcontent-%COMP%]{overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.input-download[_ngcontent-%COMP%]{background:linear-gradient(135deg,#dbeafe,#bfdbfe);color:#1e40af;border-color:#60a5fa}.input-download[_ngcontent-%COMP%]:hover{background:linear-gradient(135deg,#93c5fd,#60a5fa);transform:translateY(-2px);box-shadow:0 4px 12px #3b82f666;border-color:#3b82f6}.output-download[_ngcontent-%COMP%]{background:linear-gradient(135deg,#d1fae5,#a7f3d0);color:#065f46;border-color:#34d399}.output-download[_ngcontent-%COMP%]:hover{background:linear-gradient(135deg,#6ee7b7,#34d399);transform:translateY(-2px);box-shadow:0 4px 12px #34d39966;border-color:#10b981}.td-notes[_ngcontent-%COMP%]{max-width:250px}.notes-cell[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.5rem;color:#475569}.notes-icon[_ngcontent-%COMP%]{width:1.125rem;height:1.125rem;flex-shrink:0;color:#a78bfa}.notes-text[_ngcontent-%COMP%]{font-size:.9rem;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.no-notes[_ngcontent-%COMP%]{color:#cbd5e1;font-size:1.25rem;text-align:center;width:100%}.td-date[_ngcontent-%COMP%]{white-space:nowrap}.date-cell[_ngcontent-%COMP%]{display:inline-flex;align-items:center;gap:.5rem;background:linear-gradient(135deg,#fce7f3,#fbcfe8);color:#9f1239;padding:.625rem 1rem;border-radius:.75rem;font-weight:600;border:2px solid #f9a8d4}.date-icon[_ngcontent-%COMP%]{width:1.125rem;height:1.125rem;flex-shrink:0}.date-text[_ngcontent-%COMP%]{font-size:.875rem}.table-footer[_ngcontent-%COMP%]{padding:1.25rem 1.5rem;background:linear-gradient(135deg,#f8fafc,#f1f5f9);border-top:2px solid #e2e8f0}.footer-text[_ngcontent-%COMP%]{margin:0;font-size:.95rem;color:#64748b;font-weight:600}.footer-text[_ngcontent-%COMP%]   strong[_ngcontent-%COMP%]{color:#f97316;font-size:1.125rem}@media (max-width: 1400px){.history-table[_ngcontent-%COMP%]{font-size:.9rem}.download-btn[_ngcontent-%COMP%]{max-width:240px}}@media (max-width: 1024px){.history-container[_ngcontent-%COMP%]{padding:1.5rem}.history-table[_ngcontent-%COMP%]{min-width:1000px}}@media (max-width: 768px){.history-container[_ngcontent-%COMP%]{padding:1rem}.history-header[_ngcontent-%COMP%]{flex-direction:column;align-items:flex-start;gap:1rem}.history-title[_ngcontent-%COMP%]{font-size:1.75rem}.refresh-btn[_ngcontent-%COMP%]{width:100%;justify-content:center}.history-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%], .history-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:.875rem 1rem;font-size:.8125rem}.download-btn[_ngcontent-%COMP%]{padding:.625rem 1rem;font-size:.8125rem}}"]})};export{H as HistoryComponent};
