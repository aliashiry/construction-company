import{a as k,b as D,c as U,d as E,e as j,f as z,g as L,h as T}from"./chunk-4AZPZ7M5.js";import{a as W}from"./chunk-FOUJ4TGQ.js";import{a as R}from"./chunk-QVDO5LVI.js";import"./chunk-APXEHMAM.js";import{d as I}from"./chunk-BJ5GJOCV.js";import"./chunk-CVU5FZDJ.js";import{$ as C,$a as i,Ba as a,Ca as f,Jb as y,Ma as x,Nb as N,Pa as d,Ra as v,Sa as e,Ta as o,Ua as _,Xa as S,Ya as m,Za as p,a as M,ab as w,bb as g,cb as u,db as b,eb as h,gb as F,ha as P,ia as O}from"./chunk-YJ3CRJMJ.js";function q(s,r){if(s&1&&(e(0,"div",25)(1,"div",26),_(2,"div",27),e(3,"span"),i(4),o()()()),s&2){let n=p();a(4),w(n.successMessage||"Uploading file, please wait...")}}function A(s,r){if(s&1&&(e(0,"div",28),i(1),o()),s&2){let n=p();a(),g(" ",n.errorMessage," ")}}function B(s,r){if(s&1&&(e(0,"div",29),i(1),o()),s&2){let n=p();a(),g(" ",n.successMessage," ")}}function H(s,r){if(s&1){let n=S();e(0,"div",30)(1,"div",31)(2,"span",32),i(3,"\u{1F4C4}"),o(),i(4),o(),e(5,"button",33),m("click",function(){P(n);let c=p();return O(c.removeFile())}),i(6," Remove "),o()()}if(s&2){let n=p();a(4),g(" ",n.fileStorage.FileName," "),a(),d("disabled",n.isLoading)}}var V=class s{constructor(r,n,t){this.uploadService=r;this.authService=n;this.router=t}fileStorage={UserID:123,ProjectName:"",FileName:"",InputFileData:null,Notes:""};isUploading=!1;isLoading=!1;pollingSubscription=null;csvData=[];csvHeaders=[];showResults=!1;selectedFileName="";errorMessage="";successMessage="";ngOnInit(){let r=this.uploadService.getFileStorage();r&&(this.fileStorage=M({},r),this.selectedFileName=r.FileName);let n=this.authService.currentUserValue;n&&n.id&&(this.fileStorage.UserID=parseInt(n.id,10)||123)}ngOnDestroy(){this.stopPolling()}onFileSelected(r){let n=r.target;n.files&&n.files.length>0&&(this.fileStorage.InputFileData=n.files[0],this.fileStorage.FileName=n.files[0].name,this.selectedFileName=n.files[0].name,this.uploadService.setFileStorage(this.fileStorage),this.errorMessage="")}removeFile(){this.fileStorage.InputFileData=null,this.fileStorage.FileName="",this.selectedFileName="",this.uploadService.clearFile()}submitForm(){if(this.errorMessage="",this.successMessage="",!this.fileStorage.InputFileData||!(this.fileStorage.InputFileData instanceof File)){this.errorMessage="Please select a valid file";return}if(!this.fileStorage.ProjectName||this.fileStorage.ProjectName.trim()===""){this.errorMessage="Please enter a project name";return}if(!this.selectedFileName||this.selectedFileName.trim()===""){this.errorMessage="Please enter a file name";return}this.fileStorage.FileName=this.selectedFileName,this.isLoading=!0,this.successMessage="Uploading file, please wait...",this.showResults=!1,this.csvData=[],this.csvHeaders=[],this.uploadService.submitToInput(this.fileStorage,"https://hshama7md15.app.n8n.cloud/webhook/upload-file-dxf").subscribe({next:()=>{localStorage.setItem("lastFileOutput",JSON.stringify({userId:this.fileStorage.UserID,projectName:this.fileStorage.ProjectName,fileName:this.fileStorage.FileName})),this.successMessage="File uploaded successfully! Redirecting...",setTimeout(()=>{this.router.navigate(["/file-result"])},1e3)},error:r=>{console.error("Upload failed",r),this.isLoading=!1,this.errorMessage="Failed to upload file. Error: "+(r?.error?.message||r?.message||"Unknown error")}})}stopPolling(){this.pollingSubscription&&(this.pollingSubscription.unsubscribe(),this.pollingSubscription=null)}onSubmit(r){r.preventDefault(),this.submitForm()}resetForm(){this.fileStorage={UserID:this.fileStorage.UserID,ProjectName:"",FileName:"",InputFileData:null,Notes:""},this.selectedFileName="",this.csvData=[],this.csvHeaders=[],this.showResults=!1,this.errorMessage="",this.successMessage="",this.uploadService.clearFile()}goHome(){this.router.navigate(["/"])}static \u0275fac=function(n){return new(n||s)(f(R),f(W),f(I))};static \u0275cmp=C({type:s,selectors:[["app-upload-file"]],standalone:!0,features:[F],decls:54,vars:17,consts:[[1,"upload-page-wrapper"],[1,"upload-form-full-page"],[1,"form-container"],[1,"form-header"],[1,"highlight"],[1,"form-body"],["class","alert alert-info",4,"ngIf"],["class","alert alert-error",4,"ngIf"],["class","alert alert-success",4,"ngIf"],["id","uploadForm",3,"submit"],[1,"form-group"],["for","projectName"],[1,"required"],["type","text","id","projectName","name","projectName","placeholder","Enter your project name","required","",1,"form-control",3,"ngModelChange","ngModel","disabled"],["for","fileName"],["type","text","id","fileName","name","fileName","placeholder","Enter file name or it will be auto-filled",1,"form-control",3,"ngModelChange","ngModel","disabled"],[1,"help-text"],[1,"file-upload-wrapper"],["type","file","id","fileInput","accept",".dxf,.dwg",1,"file-upload-input",3,"change","disabled"],[1,"file-upload-icon"],[1,"file-upload-text"],["class","file-info",4,"ngIf"],["for","notes"],["id","notes","name","notes","placeholder","Add any additional notes or requirements...",1,"form-control",3,"ngModelChange","ngModel","disabled"],["type","submit","id","submitBtn",1,"btn-submit",3,"disabled"],[1,"alert","alert-info"],[1,"loading-inline"],[1,"spinner-small"],[1,"alert","alert-error"],[1,"alert","alert-success"],[1,"file-info"],[1,"file-name"],[1,"file-icon"],["type","button",1,"btn-remove",3,"click","disabled"]],template:function(n,t){n&1&&(e(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"h1"),i(5,"Upload "),e(6,"span",4),i(7,"Project Files"),o()(),e(8,"p"),i(9,"Share your DXF/DWG files with our engineering team"),o()(),e(10,"div",5),x(11,q,5,1,"div",6)(12,A,2,1,"div",7)(13,B,2,1,"div",8),e(14,"form",9),m("submit",function(l){return t.onSubmit(l)}),e(15,"div",10)(16,"label",11),i(17," Project Name "),e(18,"span",12),i(19,"*"),o()(),e(20,"input",13),h("ngModelChange",function(l){return b(t.fileStorage.ProjectName,l)||(t.fileStorage.ProjectName=l),l}),o()(),e(21,"div",10)(22,"label",14),i(23," File Name "),e(24,"span",12),i(25,"*"),o()(),e(26,"input",15),h("ngModelChange",function(l){return b(t.selectedFileName,l)||(t.selectedFileName=l),l}),o(),e(27,"small",16),i(28,"You can edit the file name before sending"),o()(),e(29,"div",10)(30,"label"),i(31," Upload File "),e(32,"span",12),i(33,"*"),o()(),e(34,"div",17)(35,"input",18),m("change",function(l){return t.onFileSelected(l)}),o(),e(36,"div",19),i(37,"\u{1F4C1}"),o(),e(38,"div",20)(39,"strong"),i(40,"Click to upload"),o(),i(41," or drag and drop"),_(42,"br"),e(43,"small"),i(44,"DXF or DWG files only"),o()()(),x(45,H,7,2,"div",21),e(46,"div",16),i(47,"Maximum file size: 50MB"),o()(),e(48,"div",10)(49,"label",22),i(50,"Notes (Optional)"),o(),e(51,"textarea",23),h("ngModelChange",function(l){return b(t.fileStorage.Notes,l)||(t.fileStorage.Notes=l),l}),o()(),e(52,"button",24),i(53),o()()()()()()),n&2&&(a(11),d("ngIf",t.isLoading),a(),d("ngIf",t.errorMessage&&!t.isLoading),a(),d("ngIf",t.successMessage&&!t.isLoading),a(7),u("ngModel",t.fileStorage.ProjectName),d("disabled",t.isLoading),a(6),u("ngModel",t.selectedFileName),d("disabled",t.isLoading),a(8),v("has-file",t.fileStorage.InputFileData)("disabled",t.isLoading),a(),d("disabled",t.isLoading),a(10),d("ngIf",t.fileStorage.InputFileData),a(6),u("ngModel",t.fileStorage.Notes),d("disabled",t.isLoading),a(),d("disabled",t.isUploading||t.isLoading),a(),g(" ",t.isLoading?"Uploading...":"Upload Project Files"," "))},dependencies:[T,z,k,D,U,L,j,E,N,y],styles:["*[_ngcontent-%COMP%]{margin:0;padding:0;box-sizing:border-box}body[_ngcontent-%COMP%]{font-family:Segoe UI,Tahoma,Geneva,Verdana,sans-serif;background:linear-gradient(135deg,#f5f7fa,#c3cfe2);min-height:100vh;padding:40px 20px}.upload-page-wrapper[_ngcontent-%COMP%]{min-height:100vh;width:100%;display:flex;flex-direction:column}.upload-form-full-page[_ngcontent-%COMP%]{min-height:100vh;width:100%;display:flex;align-items:center;justify-content:center;background:linear-gradient(135deg,#f5f7fa,#c3cfe2);padding:20px}.form-container[_ngcontent-%COMP%]{width:100%;max-width:700px;background:#fff;border-radius:20px;box-shadow:0 20px 60px #0000001a;overflow:hidden}.results-full-page[_ngcontent-%COMP%]{min-height:100vh;width:100%;background:linear-gradient(135deg,#f5f7fa,#c3cfe2);padding:40px 20px;display:flex;align-items:center;justify-content:center}.results-container[_ngcontent-%COMP%]{width:100%;max-width:1000px;background:#fff;border-radius:20px;box-shadow:0 20px 60px #0000001a;overflow:hidden;padding:40px}.results-header[_ngcontent-%COMP%]{text-align:center;margin-bottom:30px}.results-header[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{color:#1a1a2e;font-size:2rem;margin-bottom:10px;font-weight:700}.form-header[_ngcontent-%COMP%]{background:linear-gradient(135deg,#1a1a2e,#16213e);color:#fff;padding:40px 30px;text-align:center}.form-header[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{font-size:2rem;margin-bottom:10px;font-weight:700}.form-header[_ngcontent-%COMP%]   .highlight[_ngcontent-%COMP%]{color:#ff6b35}.form-header[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:#b8bcc8;font-size:.95rem}.form-body[_ngcontent-%COMP%]{padding:40px 30px}.form-group[_ngcontent-%COMP%]{margin-bottom:28px}.form-group[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:block;margin-bottom:8px;color:#2c3e50;font-weight:600;font-size:.95rem}.required[_ngcontent-%COMP%]{color:#ff6b35;margin-left:3px}.form-control[_ngcontent-%COMP%]{width:100%;padding:14px 16px;border:2px solid #e1e8ed;border-radius:10px;font-size:.95rem;transition:all .3s ease;background:#f8f9fa;font-family:inherit}.form-control[_ngcontent-%COMP%]:focus{outline:none;border-color:#ff6b35;background:#fff;box-shadow:0 0 0 3px #ff6b351a}.form-control[_ngcontent-%COMP%]:disabled{background:#e8eaed;cursor:not-allowed;color:#999}textarea.form-control[_ngcontent-%COMP%]{resize:vertical;min-height:100px}.file-upload-wrapper[_ngcontent-%COMP%]{position:relative;border:2px dashed #cbd5e0;border-radius:10px;padding:30px;text-align:center;background:#f8f9fa;transition:all .3s ease;cursor:pointer}.file-upload-wrapper[_ngcontent-%COMP%]:hover:not(:has(input:disabled)){border-color:#ff6b35;background:#fff5f2}.file-upload-wrapper.has-file[_ngcontent-%COMP%]{border-color:#ff6b35;background:#fff5f2}.file-upload-input[_ngcontent-%COMP%]{position:absolute;left:0;top:0;width:100%;height:100%;opacity:0;cursor:pointer}.file-upload-icon[_ngcontent-%COMP%]{font-size:3rem;color:#ff6b35;margin-bottom:15px}.file-upload-text[_ngcontent-%COMP%]{color:#64748b;font-size:.95rem}.file-upload-text[_ngcontent-%COMP%]   strong[_ngcontent-%COMP%]{color:#ff6b35;font-weight:600}.file-info[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between;background:#fff;padding:15px;border-radius:8px;margin-top:15px;border:1px solid #e1e8ed}.file-name[_ngcontent-%COMP%]{display:flex;align-items:center;gap:10px;color:#2c3e50;font-weight:500}.file-icon[_ngcontent-%COMP%]{color:#ff6b35;font-size:1.5rem}.btn-remove[_ngcontent-%COMP%]{background:#ef4444;color:#fff;border:none;padding:8px 16px;border-radius:6px;cursor:pointer;font-size:.85rem;font-weight:600;transition:all .3s ease}.btn-remove[_ngcontent-%COMP%]:hover:not(:disabled){background:#dc2626;transform:translateY(-1px)}.btn-remove[_ngcontent-%COMP%]:disabled{background:#cbd5e0;cursor:not-allowed}.help-text[_ngcontent-%COMP%]{color:#64748b;font-size:.85rem;margin-top:8px}.alert[_ngcontent-%COMP%]{padding:14px 16px;border-radius:8px;margin-bottom:20px;font-size:.9rem;border-left:4px solid;direction:rtl;text-align:right}.alert-error[_ngcontent-%COMP%]{background:#fee2e2;color:#991b1b;border-left-color:#dc2626}.alert-success[_ngcontent-%COMP%]{background:#dcfce7;color:#166534;border-left-color:#22c55e}.btn-submit[_ngcontent-%COMP%]{width:100%;padding:16px;background:linear-gradient(135deg,#ff6b35,#f7931e);color:#fff;border:none;border-radius:10px;font-size:1.05rem;font-weight:700;cursor:pointer;transition:all .3s ease;margin-top:10px}.btn-submit[_ngcontent-%COMP%]:hover:not(:disabled){transform:translateY(-2px);box-shadow:0 10px 25px #ff6b354d}.btn-submit[_ngcontent-%COMP%]:disabled{background:#cbd5e0;cursor:not-allowed;transform:none}.table-wrapper[_ngcontent-%COMP%]{overflow-x:auto;margin-bottom:30px;border-radius:10px;box-shadow:0 2px 10px #0000000d}.results-table[_ngcontent-%COMP%]{width:100%;border-collapse:collapse;font-size:.9rem}.results-table[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]{background:linear-gradient(135deg,#1a1a2e,#16213e);color:#fff}.results-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{padding:15px;text-align:left;font-weight:600;border:1px solid #e1e8ed}.results-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:12px 15px;border:1px solid #e1e8ed;color:#2c3e50}.results-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:nth-child(odd){background:#f8f9fa}.results-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:hover{background:#f0f5ff}.results-actions[_ngcontent-%COMP%]{display:flex;gap:15px;flex-wrap:wrap}.btn-restart[_ngcontent-%COMP%], .btn-home[_ngcontent-%COMP%]{flex:1;min-width:200px;padding:14px;border:none;border-radius:10px;font-size:1rem;font-weight:700;cursor:pointer;transition:all .3s ease}.btn-restart[_ngcontent-%COMP%]{background:linear-gradient(135deg,#ff6b35,#f7931e);color:#fff}.btn-restart[_ngcontent-%COMP%]:hover{transform:translateY(-2px);box-shadow:0 10px 25px #ff6b354d}.btn-home[_ngcontent-%COMP%]{background:#e5e7eb;color:#2c3e50}.btn-home[_ngcontent-%COMP%]:hover{background:#d1d5db;transform:translateY(-2px)}@media (max-width: 768px){.upload-form-full-page[_ngcontent-%COMP%], .results-full-page[_ngcontent-%COMP%]{padding:15px}.form-container[_ngcontent-%COMP%], .results-container[_ngcontent-%COMP%]{padding:20px}.form-header[_ngcontent-%COMP%]{padding:30px 20px}.form-header[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{font-size:1.5rem}.form-body[_ngcontent-%COMP%]{padding:20px}.results-header[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{font-size:1.5rem}.results-table[_ngcontent-%COMP%]{font-size:.8rem}.results-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%], .results-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:10px 8px}.results-actions[_ngcontent-%COMP%]{flex-direction:column}.btn-restart[_ngcontent-%COMP%], .btn-home[_ngcontent-%COMP%]{width:100%}}.alert-info[_ngcontent-%COMP%]{background-color:#3498db;color:#fff;padding:15px;border-radius:5px;margin-bottom:20px}.loading-inline[_ngcontent-%COMP%]{display:flex;align-items:center;gap:15px;font-size:16px}.spinner-small[_ngcontent-%COMP%]{border:3px solid rgba(255,255,255,.3);border-top:3px solid white;border-radius:50%;width:30px;height:30px;animation:_ngcontent-%COMP%_spin 1s linear infinite}@keyframes _ngcontent-%COMP%_spin{0%{transform:rotate(0)}to{transform:rotate(360deg)}}.form-control[_ngcontent-%COMP%]:disabled, .btn-submit[_ngcontent-%COMP%]:disabled, .btn-remove[_ngcontent-%COMP%]:disabled{opacity:.6;cursor:not-allowed;background-color:#e0e0e0}.file-upload-wrapper.disabled[_ngcontent-%COMP%]{opacity:.6;cursor:not-allowed;pointer-events:none}"]})};export{V as UploadFileComponent};
